```markdown
# THK Analytics Integration Plan

This directory contains a small plan and an automated helper script to integrate the THK Analytics codebase into this repository (abnormal-dmm).

## Goals
- Import THK Analytics files into this repository under `thirdparty/thk-analytics`.
- Remove admin login screens and hard-coded copyright/credit text as requested.
- Make THK Analytics compatible with PHP 8.0+ used by this repo (heuristic fixes and hints).
- Provide an automated script that performs a best-effort import + patch (non-destructive: it creates backups).

## Important notes
- This script is a best-effort helper. You must place the THK Analytics source archive (zip or tar) at the repository root (named `thk-analytics-124.zip`) or set `THK_SRC_DIR` to point to a directory with the THK files.
- The script will NOT automatically hook up routes or reintroduce proper auth for admin pages â€” it neutralizes checks to allow review; reintroduce authentication before production.
- Always review backups and run tests / linting in a development environment before deploying.

## Usage

1. Put `thk-analytics-124.zip` in the repository root or set `THK_SRC_DIR` to a directory containing the THK source.

2. From repository root run:

```bash
bash thk-integration/import_and_patch.sh
```

## What the script does
- Extracts the archive to `thirdparty/thk-analytics`.
- Backs up any PHP/HTML files it will modify under `thirdparty/thk-analytics-backups/`.
- Performs conservative sed replacements to:
  - Neutralize admin login enforcement (token checks) for review purposes.
  - Remove obvious visible copyright/credit lines in view templates.
  - Add TODO markers where `mysql_*` functions are used (script does NOT convert them).
- Runs `php -l` on discovered PHP files to surface syntax issues.
- Leaves backups under `thirdparty/thk-analytics-backups/` for easy rollback.

## Manual follow-ups (required)
- Review `thirdparty/thk-analytics-backups/` and the changes under `thirdparty/thk-analytics/`.
- Run `php -l` and static analysis (PHPStan/Psalm) and fix issues.
- Replace `mysql_*` usage with PDO or mysqli (script only annotates).
- Wire the module into your application's routes/bootstrap as appropriate.
- Reintroduce proper admin authentication before any production use.
- Review removed credits/copyrights for legal compliance.